/*!build time : 2014-07-30 11:45:14 AM*/
KISSY.add("kg/menu-aim/2.0.1/index",function(a){var b=a.all,c=function(d){var e=this;e.opts=a.mix(c.defs,d),e.$wrap=b(e.opts.wrap),e.$menu=b(e.opts.menu),e.locs=[],e.rNow=null,e.tOut=null,e.init()};return c.defs={wrap:"",menu:"",rows:"",dealy:300,handler:null,tolerance:0},c.prototype.getOffset=function(){var a=this,b=a.opts,c=a.$menu,d=c.offset();a.menuOffset=d,a.upperRight={x:d.left+c.outerWidth(),y:d.top-b.tolerance},a.lowerRight={x:d.left+c.outerWidth(),y:d.top+c.outerHeight()+b.tolerance}},c.prototype.bindEvent=function(){var a=this,b=a.opts,c=a.locs,d=a.rNow,e=a.tOut,f=a.menuOffset,g=a.upperRight,h=a.lowerRight,i=null,j=function(){function a(a,b){return(b.y-a.y)/(b.x-a.x)}var e=c[c.length-1],j=c[0];if(!d||!e)return 0;if(j.x<f.left||j.x>h.x||j.y<f.top||j.y>h.y)return 0;if(i&&e.x==i.x&&e.y==i.y)return 0;var k=a(e,g),l=a(e,h),m=a(j,g),n=a(j,h);return m>k&&l>n?(i=e,b.dealy):(i=null,0)},k=function(a){d!=a&&(b.handler.enterHandler(a),d=a)},l=function(a){var b=j();b?e=setTimeout(function(){l(a)},b):k(a)},m=function(a){c.push({x:a.pageX,y:a.pageY}),c.length>3&&c.shift()},n=function(){d=null,b.handler.leaveHandler()},o=function(){e&&clearTimeout(e)},p=function(a){e&&clearTimeout(e),l(a.currentTarget)};a.$wrap.on("mousemove",m).on("mouseleave",n),a.$menu.on("mouseleave",o).delegate("mouseenter",b.rows,p)},c.prototype.init=function(){this.getOffset(),this.bindEvent()},c},{requires:["node"]});